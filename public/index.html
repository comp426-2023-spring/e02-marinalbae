<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Rock, Paper, Scissors</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      text-align: center;
    }
    button {
      font-size: 1.5rem;
      padding: 10px 20px;
      margin: 10px;
    }
    .result {
      font-size: 2rem;
      margin-top: 20px;
    }
  </style>
</head>
<body>
  <h1>Rock, Paper, Scissors</h1>
  <label>
    <p id="modetext" id="modetext" style="display:inline"> Select a Game Mode:</p>	  
    <input type="radio" id="rps" name="game" value="standard" checked> Standard
  </label>
  <label>
    <input type="radio" id="rpsls" name="game" value="lizard-spock"> Lizard-Spock
  </label>
  <br>
  <label>
    <p id="versus" id="versus" style="display:inline"> Who Will You Play Against:</p>
    <input type="radio" name="mode" value="computer" checked> Computer
  </label>
  <label>
    <input type="radio" name="mode" value="player"> Player 2
  </label>
  <br>
  <p id="versus" id="versus"> Player 1, Select Your Move to Throw Down!</p>
  <div id="choices">
    <button onclick="play('rock')">Rock</button>
    <button onclick="play('paper')">Paper</button>
    <button onclick="play('scissors')">Scissors</button>
  </div>
  <br>
  <p id="player2-moves" style="display: none;">
    Player 2, Select Your Move to Throw Down!
  </p>
  <div id="player2-buttons" style="display: none;">
    <button onclick="setPlayer2Choice('rock')">Rock</button>
    <button onclick="setPlayer2Choice('paper')">Paper</button>
    <button onclick="setPlayer2Choice('scissors')">Scissors</button>
  </div>
  <p id="player1-choice" style="display: none;"></p>
  <p id="player2-choice" style="display: none;"></p>
  <p id="computer-choice" style="display: none;"></p>
  <p class="result" id="result"></p>
  <button onclick="resetGame()">Reset</button>
  <p><a href="rules.html">Rules</a></p>

  <script>
    let player1Choice;
    let player2Choice;
    let choices;

    function play(choice) {
      player1Choice = choice;
      
      const mode = document.querySelector('input[name="mode"]:checked').value;
      document.getElementById('player1-choice').innerText = 'Player 1 Chose: ' + choice;
      document.getElementById('player1-choice').style.display = 'block';

      if (mode === 'computer') {
        playAgainstComputer();
      } else {
        document.getElementById('player2-moves').style.display = 'block';
        document.getElementById('player2-buttons').style.display = 'block';
      }
    }

    function playAgainstComputer() {
      choices = getChoices();
      player2Choice = choices[Math.floor(Math.random() * choices.length)];

      document.getElementById('computer-choice').innerText = 'Computer Chose: ' + player2Choice;
      document.getElementById('computer-choice').style.display = 'block';

      determineWinner();
    }

    function setPlayer2Choice(choice) {
      player2Choice = choice;
      document.getElementById('player2-choice').innerText = 'Player 2 Chose: ' + choice;
      document.getElementById('player2-choice').style.display = 'block';
      determineWinner();
    }

    function determineWinner() {
        let rps_checked = document.getElementById("rps").checked;
        let rpsls_checked = document.getElementById("rpsls").checked;

        let mode = rps_checked ? "rps" : "rpsls"
        
      let api = `${document.baseURI}app/${mode}/play/${player1Choice}`;
	
//	await fetch(api)
//        .then(function(response) {
//            return response.json();
//        })
//            .then(function(result) {
//                console.log(result)
//		document.getElementById('result').innerText = result.result;
//		      });
//	I couldn't get the URL to work so I hard coded the results.

      if (player1Choice === player2Choice) {
        document.getElementById('result').innerText = 'It\'s a tie!';
      } else {
        const winningChoices = {
          'rock': ['scissors', 'lizard'],
          'paper': ['rock', 'spock'],
          'scissors': ['paper', 'lizard'],
          'lizard': ['paper', 'spock'],
          'spock': ['rock', 'scissors']
        };

        if (winningChoices[player1Choice].includes(player2Choice)) {
          document.getElementById('result').innerText = 'Player 1 wins!';
        } else {
          document.getElementById('result').innerText = 'Player 2 wins!';
        }
      }
    }

    function resetGame() {
      document.getElementById('computer-choice').style.display = 'none';
      document.getElementById('player2-buttons').style.display = 'none';
      document.getElementById('player2-moves').style.display = 'none';
      document.getElementById('result').innerText = '';
      document.getElementById('player1-choice').innerText = '';
      document.getElementById('player2-choice').innerText = '';

      updateChoices();
    }

    function updateChoices() {
      const gameVariant = document.querySelector('input[name="game"]:checked').value;
      choices = getChoices(gameVariant);

      document.getElementById('choices').innerHTML = choices.map(choice => {
        return `<button onclick="play('${choice}')">${choice.charAt(0).toUpperCase() + choice.slice(1)}</button>`;
      }).join('');

      document.getElementById('player2-buttons').innerHTML = choices.map(choice => {
        return `<button onclick="setPlayer2Choice('${choice}')">${choice.charAt(0).toUpperCase() + choice.slice(1)}</button>`;
      }).join('');
    }

    function getChoices(gameVariant) {
      if (gameVariant === 'lizard-spock') {
        return ['rock', 'paper', 'scissors', 'lizard', 'spock'];
      }
      return ['rock', 'paper', 'scissors'];
    }

    document.querySelectorAll('input[name="game"]').forEach(input => {
      input.addEventListener('change', updateChoices);
    });

    updateChoices();
  </script>
</body>
</html>


